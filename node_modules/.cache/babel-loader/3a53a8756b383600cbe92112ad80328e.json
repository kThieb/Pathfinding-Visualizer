{"ast":null,"code":"var _jsxFileName = \"/home/kevin/Documents/Projects/Simple-Visualizer/pathfinding-visualizer/src/Visualizer/Visualizer.tsx\";\nimport React, { useEffect, useRef, useState } from \"react\";\nimport \"./Visualizer.css\";\nimport { Grid } from \"../Grid/Grid\";\nimport { NavBar, NavItem, DropDownMenu, DropDownItem, DropDownSlider, NavButton } from \"../NavBar/NavBar\";\nimport { node } from \"../helperFunctions/usefulInterfaces\";\nimport { singleTargetAlgorithms, multipleTargetsAlgorithms } from \"../helperFunctions/shortestPathAlgorithms/allAlgorithms\";\nimport { generateMazeGraph } from \"../helperFunctions/mazeGenerators/mazeGraph\";\nimport { constructGrid } from \"../helperFunctions/constructGrid\";\nimport { WrapperCSSTransition } from \"../Wrapper/Wrapper\";\nconst NUMBER_OF_COLUMNS = 28;\nconst NUMBER_OF_ROWS = 13;\nconst VISITED_ANIMATION_TIMEOUT = 35;\nconst PATH_ANIMATION_TIMEOUT = 80; // We define these constants out of the functional component\n// that the App uses to avoid re-running the functions to create\n// these each time there is a re-render\n\nconst [firstGrid, firstStartNode, firstTargetList] = constructGrid(NUMBER_OF_COLUMNS, NUMBER_OF_ROWS, [6, 3], [6, 24], false);\nconst [firstpairGrid, mazeGraph] = generateMazeGraph(NUMBER_OF_COLUMNS, NUMBER_OF_ROWS, firstGrid, 0.3, 0.3, 5); // Component rendering everything in the webpage.\n\nconst Visualizer = () => {\n  // States managing the grid\n  const [grid, setGrid] = useState(firstGrid);\n  const [maze, setMaze] = useState(mazeGraph);\n  const [pairGrid, setPairGrid] = useState(firstpairGrid);\n  const [wallsDensity, setWallsDensity] = useState(0.3);\n  const [mudDensity, setMudDensity] = useState(0.3);\n  const [isVisualized, setIsVisualized] = useState(0);\n  const [mudWeight, setMudWeight] = useState(3);\n  const [multipleTargets, setMultipleTargets] = useState(false);\n  const gridRef = useRef(firstGrid); // States of the start and end node\n\n  const [startNode, setStartNode] = useState(firstStartNode);\n  const [targetList, setTargetList] = useState(firstTargetList); // States managing the dropdown menu\n\n  const [algoActiveMenu, setAlgoActiveMenu] = useState(\"main-single-target\");\n  const [singleTargetAlgorithm, setSingleTargetAlgorithm] = useState(\"Dijkstra's algorithm\");\n  const [multipleTargetsAlgorithm, setMultipleTargetsAlgorithm] = useState(\"Greedy\");\n  const [height, setHeight] = useState(undefined); // State of the mouse\n\n  const [mouseIsPressed, setMouseIsPressed] = useState(false); // This function is there to visualize the algorithm chosen in the drop down menu\n\n  const visualizeSingleTargetAlgorithm = (visited, path, timeout) => {\n    const n = visited.length;\n\n    for (let i = 0; i < n; i++) {\n      setTimeout(() => {\n        const newGrid = gridRef.current.slice();\n        const node = visited[i]; // define the x and y of the current node\n\n        const x = node.x;\n        const y = node.y;\n        const newNode = { ...newGrid[x][y],\n          isVisited: true\n        };\n        newGrid[x][y] = newNode;\n        setGrid(newGrid);\n      }, timeout + VISITED_ANIMATION_TIMEOUT * i);\n    }\n\n    const m = path.length;\n\n    for (let i = 0; i < m; i++) {\n      setTimeout(() => {\n        const newGrid = gridRef.current.slice();\n        let successor = i < m - 1 ? path[i + 1] : path[i];\n        const node = path[i]; // define the x and y of the current node\n\n        const x = node.x;\n        const y = node.y;\n        const newNode = { ...newGrid[x][y],\n          isShortestPath: true,\n          successorPosition: getSuccessorPosition(node, successor)\n        };\n        newGrid[x][y] = newNode;\n        setGrid(newGrid);\n      }, timeout + VISITED_ANIMATION_TIMEOUT * n + PATH_ANIMATION_TIMEOUT * i);\n    }\n\n    return timeout + VISITED_ANIMATION_TIMEOUT * n + PATH_ANIMATION_TIMEOUT * m;\n  }; // This function returns the position of the successor of a node in the shortest path\n\n\n  const getSuccessorPosition = (node, successor) => {\n    if (node.x + 1 === successor.x) return \"D\";\n    if (node.y + 1 === successor.y) return \"R\";\n    if (node.x - 1 === successor.x) return \"U\";\n    if (node.y - 1 === successor.y) return \"L\";\n    return \"\";\n  }; // This function is there to visualize multipleTargetsAlgorithms\n\n\n  const visualizeMultipleTargetsAlgorithm = allVisitedAndPathsArray => {\n    let n = allVisitedAndPathsArray.length;\n    let currentTimeout = 0;\n\n    for (let i = 0; i < n; i++) {\n      const [visited, path] = allVisitedAndPathsArray[i];\n      currentTimeout = visualizeSingleTargetAlgorithm(visited, path, currentTimeout);\n    }\n\n    return currentTimeout;\n  }; // This function is passed to the drop down menu to handle the change of algorithm\n\n\n  const handleAlgorithmChange = algorithmName => {\n    return () => {\n      setSingleTargetAlgorithm(algorithmName);\n    };\n  }; // This function handles the click on the menu buttons\n\n\n  const handleMenuChange = menuName => {\n    return () => setAlgoActiveMenu(menuName);\n  }; // This function handles the logic of the visualization of the algorithms\n\n\n  const handleVisualization = () => {\n    if (isVisualized === 0) {\n      setIsVisualized(1);\n\n      if (!multipleTargets) {\n        const [visited, path] = singleTargetAlgorithms[singleTargetAlgorithm](grid, pairGrid, maze, startNode, targetList);\n        const n = visited.length,\n              m = path.length;\n        visualizeSingleTargetAlgorithm(visited, path, 0);\n        setTimeout(() => {\n          setIsVisualized(2);\n        }, VISITED_ANIMATION_TIMEOUT * n + PATH_ANIMATION_TIMEOUT * m);\n        return;\n      }\n\n      const allVisitedAndPaths = multipleTargetsAlgorithms[multipleTargetsAlgorithm](grid, pairGrid, maze, startNode, targetList.slice());\n      const timeout = visualizeMultipleTargetsAlgorithm(allVisitedAndPaths);\n      setTimeout(() => {\n        setIsVisualized(2);\n      }, timeout);\n    }\n  }; // This function calls the generate maze function\n\n\n  const generateMaze = () => {\n    if (isVisualized === 0) {\n      const newGrid = grid.slice();\n      const [newPairGrid, newMaze] = generateMazeGraph(NUMBER_OF_COLUMNS, NUMBER_OF_ROWS, newGrid, wallsDensity, mudDensity, mudWeight);\n      setGrid(newGrid);\n      setPairGrid(newPairGrid);\n      setMaze(newMaze);\n    }\n  }; // Reinitialize the the board\n\n\n  const reinitializeGrid = () => {\n    if (isVisualized !== 1) {\n      const [newGrid, newStartNode, newTargetList] = constructGrid(NUMBER_OF_COLUMNS, NUMBER_OF_ROWS, [startNode.x, startNode.y], [targetList[0].x, targetList[0].y], multipleTargets);\n\n      for (let i = 0; i < newGrid.length; i++) {\n        for (let j = 0; j < newGrid[0].length; j++) {\n          gridRef.current[i][j] = newGrid[i][j];\n        }\n      }\n\n      setGrid(newGrid);\n      setStartNode(newStartNode);\n      setTargetList(newTargetList);\n      setIsVisualized(0);\n    }\n  }; // If the value of multipleTargets change, call the reinitialize function\n\n\n  useEffect(reinitializeGrid, [multipleTargets]);\n\n  const toggleStartNode = (x, y) => {\n    const [newGrid, newStartNode, newTargetList] = constructGrid(NUMBER_OF_COLUMNS, NUMBER_OF_ROWS, [x, y], [targetList[0].x, targetList[0].y], multipleTargets);\n    setStartNode(newStartNode);\n    setTargetList(newTargetList);\n    setGrid(newGrid);\n  }; // handles the case when the mouse button is down\n\n\n  const handleMouseDown = (x, y) => {\n    if (grid[x][y] === startNode) {\n      setMouseIsPressed(true);\n    }\n  }; // handles the case whan the mouse button is down and you enter a node\n\n\n  const handleMouseEnter = (x, y) => {\n    if (mouseIsPressed) {\n      toggleStartNode(x, y);\n    }\n  }; // handles the case when you mouse up\n\n\n  const handleMouseUp = () => {\n    setMouseIsPressed(false);\n  }; // Render the app\n\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"App\",\n    onMouseUp: () => handleMouseUp(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 269,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(NavBar, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 270,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(NavButton, {\n    text: \"Reinitialize\",\n    isVisualized: isVisualized,\n    className: \"reinitialize\",\n    startClassName: \"greyed-out\",\n    visualizingClassName: \"greyed-out\",\n    visualizedClassName: \"highlight\",\n    handleClick: reinitializeGrid,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 271,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(NavButton, {\n    text: \"Generate Maze\",\n    isVisualized: isVisualized,\n    className: \"generate-maze\",\n    visualizingClassName: \"greyed-out\",\n    visualizedClassName: \"greyed-out\",\n    handleClick: generateMaze,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 280,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(NavItem, {\n    text: \"Maze options\",\n    id: \"maze-options\",\n    isVisualized: isVisualized,\n    shouldGreyOut: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 288,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(DropDownMenu, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 294,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(DropDownSlider, {\n    text: \"Density of walls\",\n    minValue: 0,\n    maxValue: 1,\n    step: 0.01,\n    defaultValue: wallsDensity,\n    handleChange: setWallsDensity,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 295,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(DropDownSlider, {\n    text: \"Density of mud\",\n    minValue: 0,\n    maxValue: 1,\n    step: 0.01,\n    defaultValue: mudDensity,\n    handleChange: setMudDensity,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 303,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(DropDownSlider, {\n    text: \"Mud Weight\",\n    minValue: 1,\n    maxValue: 5,\n    step: 1,\n    defaultValue: mudWeight,\n    handleChange: setMudWeight,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 311,\n      columnNumber: 13\n    }\n  }))), /*#__PURE__*/React.createElement(NavButton, {\n    text: \"Visualize \" + singleTargetAlgorithm + \"!\",\n    isVisualized: isVisualized,\n    className: \"visualize-button\",\n    visualizingClassName: \"greyed-out\",\n    visualizedClassName: \"greyed-out\",\n    handleClick: handleVisualization,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 321,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(NavButton, {\n    text: \"Enable Multiple Targets\",\n    isVisualized: isVisualized,\n    className: \"\",\n    visualizingClassName: \"\",\n    visualizedClassName: \"\",\n    handleClick: () => setMultipleTargets(!multipleTargets),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 329,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(NavItem, {\n    text: \"Algorithms\",\n    id: \"algorithms\",\n    isVisualized: isVisualized,\n    shouldGreyOut: false,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 337,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(DropDownMenu, {\n    height: height,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 343,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(WrapperCSSTransition, {\n    in: algoActiveMenu === \"main-single-target\",\n    unmountOnExit: true,\n    timeout: 500,\n    classNames: \"menu-primary\",\n    handleEnter: setHeight,\n    appear: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 344,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(DropDownItem, {\n    handleClick: handleMenuChange(\"unweighted\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 352,\n      columnNumber: 15\n    }\n  }, \"Algorithms for unweighted graphs\"), /*#__PURE__*/React.createElement(DropDownItem, {\n    handleClick: handleMenuChange(\"weighted\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 355,\n      columnNumber: 15\n    }\n  }, \"Algorithms for weighted graphs\")), /*#__PURE__*/React.createElement(WrapperCSSTransition, {\n    in: algoActiveMenu === \"unweighted\",\n    unmountOnExit: true,\n    timeout: 500,\n    classNames: \"menu-unweighted\",\n    handleEnter: setHeight,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 359,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(DropDownItem, {\n    handleClick: handleMenuChange(\"main-single-target\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 366,\n      columnNumber: 15\n    }\n  }, \"<<<\"), /*#__PURE__*/React.createElement(DropDownItem, {\n    handleClick: handleAlgorithmChange(\"Depth First Search\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 371,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 374,\n      columnNumber: 17\n    }\n  }, \"Random Depth First Search\"), singleTargetAlgorithm === \"Depth First Search\" ? /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 375,\n      columnNumber: 67\n    }\n  }, \"\\u2713\") : \"\"), /*#__PURE__*/React.createElement(DropDownItem, {\n    handleClick: handleAlgorithmChange(\"Breadth First Search\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 377,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 380,\n      columnNumber: 17\n    }\n  }, \"Breadth First Search\"), singleTargetAlgorithm === \"Breadth First Search\" ? /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 382,\n      columnNumber: 19\n    }\n  }, \"\\u2713\") : \"\")), /*#__PURE__*/React.createElement(WrapperCSSTransition, {\n    in: algoActiveMenu === \"weighted\",\n    unmountOnExit: true,\n    timeout: 500,\n    classNames: \"menu-weighted\",\n    handleEnter: setHeight,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 388,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(DropDownItem, {\n    handleClick: handleMenuChange(\"main-single-target\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 395,\n      columnNumber: 15\n    }\n  }, \"<<<\"), /*#__PURE__*/React.createElement(DropDownItem, {\n    handleClick: handleAlgorithmChange(\"Dijkstra's algorithm\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 400,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 403,\n      columnNumber: 17\n    }\n  }, \"Dijkstra's Algorithm\"), singleTargetAlgorithm === \"Dijkstra's algorithm\" ? /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 405,\n      columnNumber: 19\n    }\n  }, \"\\u2713\") : \"\"), /*#__PURE__*/React.createElement(DropDownItem, {\n    handleClick: handleAlgorithmChange(\"A* algorithm\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 410,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 411,\n      columnNumber: 17\n    }\n  }, \"A* Algorithm\"), singleTargetAlgorithm === \"A* algorithm\" ? /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 412,\n      columnNumber: 61\n    }\n  }, \"\\u2713\") : \"\"))))), /*#__PURE__*/React.createElement(Grid, {\n    grid: grid,\n    pairGrid: pairGrid,\n    maze: maze,\n    mouseState: mouseIsPressed,\n    handleMouseDown: handleMouseDown,\n    handleMouseEnter: handleMouseEnter,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 419,\n      columnNumber: 7\n    }\n  }));\n};\n\nexport default Visualizer;","map":{"version":3,"sources":["/home/kevin/Documents/Projects/Simple-Visualizer/pathfinding-visualizer/src/Visualizer/Visualizer.tsx"],"names":["React","useEffect","useRef","useState","Grid","NavBar","NavItem","DropDownMenu","DropDownItem","DropDownSlider","NavButton","node","singleTargetAlgorithms","multipleTargetsAlgorithms","generateMazeGraph","constructGrid","WrapperCSSTransition","NUMBER_OF_COLUMNS","NUMBER_OF_ROWS","VISITED_ANIMATION_TIMEOUT","PATH_ANIMATION_TIMEOUT","firstGrid","firstStartNode","firstTargetList","firstpairGrid","mazeGraph","Visualizer","grid","setGrid","maze","setMaze","pairGrid","setPairGrid","wallsDensity","setWallsDensity","mudDensity","setMudDensity","isVisualized","setIsVisualized","mudWeight","setMudWeight","multipleTargets","setMultipleTargets","gridRef","startNode","setStartNode","targetList","setTargetList","algoActiveMenu","setAlgoActiveMenu","singleTargetAlgorithm","setSingleTargetAlgorithm","multipleTargetsAlgorithm","setMultipleTargetsAlgorithm","height","setHeight","undefined","mouseIsPressed","setMouseIsPressed","visualizeSingleTargetAlgorithm","visited","path","timeout","n","length","i","setTimeout","newGrid","current","slice","x","y","newNode","isVisited","m","successor","isShortestPath","successorPosition","getSuccessorPosition","visualizeMultipleTargetsAlgorithm","allVisitedAndPathsArray","currentTimeout","handleAlgorithmChange","algorithmName","handleMenuChange","menuName","handleVisualization","allVisitedAndPaths","generateMaze","newPairGrid","newMaze","reinitializeGrid","newStartNode","newTargetList","j","toggleStartNode","handleMouseDown","handleMouseEnter","handleMouseUp"],"mappings":"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","sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\nimport \"./Visualizer.css\";\nimport { Grid } from \"../Grid/Grid\";\nimport {\n  NavBar,\n  NavItem,\n  DropDownMenu,\n  DropDownItem,\n  DropDownSlider,\n  NavButton,\n} from \"../NavBar/NavBar\";\nimport { node } from \"../helperFunctions/usefulInterfaces\";\nimport {\n  singleTargetAlgorithms,\n  multipleTargetsAlgorithms,\n} from \"../helperFunctions/shortestPathAlgorithms/allAlgorithms\";\nimport { generateMazeGraph } from \"../helperFunctions/mazeGenerators/mazeGraph\";\nimport { constructGrid } from \"../helperFunctions/constructGrid\";\nimport { WrapperCSSTransition } from \"../Wrapper/Wrapper\";\n\nconst NUMBER_OF_COLUMNS: number = 28;\nconst NUMBER_OF_ROWS: number = 13;\nconst VISITED_ANIMATION_TIMEOUT: number = 35;\nconst PATH_ANIMATION_TIMEOUT: number = 80;\n\n// We define these constants out of the functional component\n// that the App uses to avoid re-running the functions to create\n// these each time there is a re-render\nconst [firstGrid, firstStartNode, firstTargetList] = constructGrid(\n  NUMBER_OF_COLUMNS,\n  NUMBER_OF_ROWS,\n  [6, 3],\n  [6, 24],\n  false\n);\n\nconst [firstpairGrid, mazeGraph] = generateMazeGraph(\n  NUMBER_OF_COLUMNS,\n  NUMBER_OF_ROWS,\n  firstGrid,\n  0.3,\n  0.3,\n  5\n);\n\n// Component rendering everything in the webpage.\nconst Visualizer: React.FC = () => {\n  // States managing the grid\n  const [grid, setGrid] = useState(firstGrid);\n  const [maze, setMaze] = useState(mazeGraph);\n  const [pairGrid, setPairGrid] = useState(firstpairGrid);\n  const [wallsDensity, setWallsDensity] = useState(0.3);\n  const [mudDensity, setMudDensity] = useState(0.3);\n  const [isVisualized, setIsVisualized] = useState(0);\n  const [mudWeight, setMudWeight] = useState(3);\n  const [multipleTargets, setMultipleTargets] = useState(false);\n  const gridRef = useRef(firstGrid);\n\n  // States of the start and end node\n  const [startNode, setStartNode] = useState(firstStartNode);\n  const [targetList, setTargetList] = useState(firstTargetList);\n\n  // States managing the dropdown menu\n  const [algoActiveMenu, setAlgoActiveMenu] = useState(\"main-single-target\");\n  const [singleTargetAlgorithm, setSingleTargetAlgorithm] = useState(\n    \"Dijkstra's algorithm\"\n  );\n  const [multipleTargetsAlgorithm, setMultipleTargetsAlgorithm] = useState(\n    \"Greedy\"\n  );\n  const [height, setHeight] = useState(undefined);\n\n  // State of the mouse\n  const [mouseIsPressed, setMouseIsPressed] = useState(false);\n\n  // This function is there to visualize the algorithm chosen in the drop down menu\n  const visualizeSingleTargetAlgorithm: (\n    visited: node[],\n    path: node[],\n    timeout: number\n  ) => number = (visited, path, timeout) => {\n    const n = visited.length;\n    for (let i: number = 0; i < n; i++) {\n      setTimeout(() => {\n        const newGrid: node[][] = gridRef.current.slice();\n        const node: node = visited[i];\n        // define the x and y of the current node\n        const x: number = node.x;\n        const y: number = node.y;\n        const newNode: node = {\n          ...newGrid[x][y],\n          isVisited: true,\n        };\n        newGrid[x][y] = newNode;\n        setGrid(newGrid);\n      }, timeout + VISITED_ANIMATION_TIMEOUT * i);\n    }\n\n    const m = path.length;\n    for (let i: number = 0; i < m; i++) {\n      setTimeout(() => {\n        const newGrid: node[][] = gridRef.current.slice();\n        let successor: node = i < m - 1 ? path[i + 1] : path[i];\n        const node: node = path[i];\n        // define the x and y of the current node\n        const x: number = node.x;\n        const y: number = node.y;\n\n        const newNode: node = {\n          ...newGrid[x][y],\n          isShortestPath: true,\n          successorPosition: getSuccessorPosition(node, successor),\n        };\n        newGrid[x][y] = newNode;\n        setGrid(newGrid);\n      }, timeout + VISITED_ANIMATION_TIMEOUT * n + PATH_ANIMATION_TIMEOUT * i);\n    }\n    return timeout + VISITED_ANIMATION_TIMEOUT * n + PATH_ANIMATION_TIMEOUT * m;\n  };\n\n  // This function returns the position of the successor of a node in the shortest path\n  const getSuccessorPosition: (node: node, successor: node) => string = (\n    node,\n    successor\n  ) => {\n    if (node.x + 1 === successor.x) return \"D\";\n    if (node.y + 1 === successor.y) return \"R\";\n    if (node.x - 1 === successor.x) return \"U\";\n    if (node.y - 1 === successor.y) return \"L\";\n    return \"\";\n  };\n\n  // This function is there to visualize multipleTargetsAlgorithms\n  const visualizeMultipleTargetsAlgorithm: (\n    allVisitedAndPathsArray: [node[], node[]][]\n  ) => number = (allVisitedAndPathsArray) => {\n    let n: number = allVisitedAndPathsArray.length;\n    let currentTimeout: number = 0;\n    for (let i: number = 0; i < n; i++) {\n      const [visited, path] = allVisitedAndPathsArray[i];\n      currentTimeout = visualizeSingleTargetAlgorithm(\n        visited,\n        path,\n        currentTimeout\n      );\n    }\n    return currentTimeout;\n  };\n\n  // This function is passed to the drop down menu to handle the change of algorithm\n  const handleAlgorithmChange: (algorithmName: string) => () => void = (\n    algorithmName\n  ) => {\n    return () => {\n      setSingleTargetAlgorithm(algorithmName);\n    };\n  };\n\n  // This function handles the click on the menu buttons\n  const handleMenuChange: (menuName: string) => () => void = (menuName) => {\n    return () => setAlgoActiveMenu(menuName);\n  };\n\n  // This function handles the logic of the visualization of the algorithms\n  const handleVisualization: () => void = () => {\n    if (isVisualized === 0) {\n      setIsVisualized(1);\n      if (!multipleTargets) {\n        const [visited, path]: [node[], node[]] = singleTargetAlgorithms[\n          singleTargetAlgorithm\n        ](grid, pairGrid, maze, startNode, targetList);\n        const n: number = visited.length,\n          m: number = path.length;\n        visualizeSingleTargetAlgorithm(visited, path, 0);\n        setTimeout(() => {\n          setIsVisualized(2);\n        }, VISITED_ANIMATION_TIMEOUT * n + PATH_ANIMATION_TIMEOUT * m);\n        return;\n      }\n      const allVisitedAndPaths: [node[], node[]][] = multipleTargetsAlgorithms[\n        multipleTargetsAlgorithm\n      ](grid, pairGrid, maze, startNode, targetList.slice());\n      const timeout: number = visualizeMultipleTargetsAlgorithm(\n        allVisitedAndPaths\n      );\n      setTimeout(() => {\n        setIsVisualized(2);\n      }, timeout);\n    }\n  };\n\n  // This function calls the generate maze function\n  const generateMaze: () => void = () => {\n    if (isVisualized === 0) {\n      const newGrid = grid.slice();\n      const [newPairGrid, newMaze] = generateMazeGraph(\n        NUMBER_OF_COLUMNS,\n        NUMBER_OF_ROWS,\n        newGrid,\n        wallsDensity,\n        mudDensity,\n        mudWeight\n      );\n      setGrid(newGrid);\n      setPairGrid(newPairGrid);\n      setMaze(newMaze);\n    }\n  };\n\n  // Reinitialize the the board\n  const reinitializeGrid: () => void = () => {\n    if (isVisualized !== 1) {\n      const [newGrid, newStartNode, newTargetList] = constructGrid(\n        NUMBER_OF_COLUMNS,\n        NUMBER_OF_ROWS,\n        [startNode.x, startNode.y],\n        [targetList[0].x, targetList[0].y],\n        multipleTargets\n      );\n      for (let i: number = 0; i < newGrid.length; i++) {\n        for (let j: number = 0; j < newGrid[0].length; j++) {\n          gridRef.current[i][j] = newGrid[i][j];\n        }\n      }\n      setGrid(newGrid);\n      setStartNode(newStartNode);\n      setTargetList(newTargetList);\n      setIsVisualized(0);\n    }\n  };\n\n  // If the value of multipleTargets change, call the reinitialize function\n  useEffect(reinitializeGrid, [multipleTargets]);\n\n  const toggleStartNode: (x: number, y: number) => void = (x, y) => {\n    const [newGrid, newStartNode, newTargetList] = constructGrid(\n      NUMBER_OF_COLUMNS,\n      NUMBER_OF_ROWS,\n      [x, y],\n      [targetList[0].x, targetList[0].y],\n      multipleTargets\n    );\n    setStartNode(newStartNode);\n    setTargetList(newTargetList);\n    setGrid(newGrid);\n  };\n\n  // handles the case when the mouse button is down\n  const handleMouseDown: (x: number, y: number) => void = (x, y) => {\n    if (grid[x][y] === startNode) {\n      setMouseIsPressed(true);\n    }\n  };\n\n  // handles the case whan the mouse button is down and you enter a node\n  const handleMouseEnter: (x: number, y: number) => void = (x, y) => {\n    if (mouseIsPressed) {\n      toggleStartNode(x, y);\n    }\n  };\n\n  // handles the case when you mouse up\n  const handleMouseUp: () => void = () => {\n    setMouseIsPressed(false);\n  };\n\n  // Render the app\n  return (\n    <div className=\"App\" onMouseUp={() => handleMouseUp()}>\n      <NavBar>\n        <NavButton\n          text=\"Reinitialize\"\n          isVisualized={isVisualized}\n          className=\"reinitialize\"\n          startClassName=\"greyed-out\"\n          visualizingClassName=\"greyed-out\"\n          visualizedClassName=\"highlight\"\n          handleClick={reinitializeGrid}\n        />\n        <NavButton\n          text=\"Generate Maze\"\n          isVisualized={isVisualized}\n          className=\"generate-maze\"\n          visualizingClassName=\"greyed-out\"\n          visualizedClassName=\"greyed-out\"\n          handleClick={generateMaze}\n        />\n        <NavItem\n          text=\"Maze options\"\n          id=\"maze-options\"\n          isVisualized={isVisualized}\n          shouldGreyOut={true}\n        >\n          <DropDownMenu>\n            <DropDownSlider\n              text=\"Density of walls\"\n              minValue={0}\n              maxValue={1}\n              step={0.01}\n              defaultValue={wallsDensity}\n              handleChange={setWallsDensity}\n            ></DropDownSlider>\n            <DropDownSlider\n              text=\"Density of mud\"\n              minValue={0}\n              maxValue={1}\n              step={0.01}\n              defaultValue={mudDensity}\n              handleChange={setMudDensity}\n            ></DropDownSlider>\n            <DropDownSlider\n              text=\"Mud Weight\"\n              minValue={1}\n              maxValue={5}\n              step={1}\n              defaultValue={mudWeight}\n              handleChange={setMudWeight}\n            ></DropDownSlider>\n          </DropDownMenu>\n        </NavItem>\n        <NavButton\n          text={\"Visualize \" + singleTargetAlgorithm + \"!\"}\n          isVisualized={isVisualized}\n          className=\"visualize-button\"\n          visualizingClassName=\"greyed-out\"\n          visualizedClassName=\"greyed-out\"\n          handleClick={handleVisualization}\n        />\n        <NavButton\n          text=\"Enable Multiple Targets\"\n          isVisualized={isVisualized}\n          className=\"\"\n          visualizingClassName=\"\"\n          visualizedClassName=\"\"\n          handleClick={() => setMultipleTargets(!multipleTargets)}\n        />\n        <NavItem\n          text=\"Algorithms\"\n          id=\"algorithms\"\n          isVisualized={isVisualized}\n          shouldGreyOut={false}\n        >\n          <DropDownMenu height={height}>\n            <WrapperCSSTransition\n              in={algoActiveMenu === \"main-single-target\"}\n              unmountOnExit\n              timeout={500}\n              classNames=\"menu-primary\"\n              handleEnter={setHeight}\n              appear\n            >\n              <DropDownItem handleClick={handleMenuChange(\"unweighted\")}>\n                Algorithms for unweighted graphs\n              </DropDownItem>\n              <DropDownItem handleClick={handleMenuChange(\"weighted\")}>\n                Algorithms for weighted graphs\n              </DropDownItem>\n            </WrapperCSSTransition>\n            <WrapperCSSTransition\n              in={algoActiveMenu === \"unweighted\"}\n              unmountOnExit\n              timeout={500}\n              classNames=\"menu-unweighted\"\n              handleEnter={setHeight}\n            >\n              <DropDownItem\n                handleClick={handleMenuChange(\"main-single-target\")}\n              >\n                {\"<<<\"}\n              </DropDownItem>\n              <DropDownItem\n                handleClick={handleAlgorithmChange(\"Depth First Search\")}\n              >\n                <p>Random Depth First Search</p>\n                {singleTargetAlgorithm === \"Depth First Search\" ? <p>✓</p> : \"\"}\n              </DropDownItem>\n              <DropDownItem\n                handleClick={handleAlgorithmChange(\"Breadth First Search\")}\n              >\n                <p>Breadth First Search</p>\n                {singleTargetAlgorithm === \"Breadth First Search\" ? (\n                  <p>✓</p>\n                ) : (\n                  \"\"\n                )}\n              </DropDownItem>\n            </WrapperCSSTransition>\n            <WrapperCSSTransition\n              in={algoActiveMenu === \"weighted\"}\n              unmountOnExit\n              timeout={500}\n              classNames=\"menu-weighted\"\n              handleEnter={setHeight}\n            >\n              <DropDownItem\n                handleClick={handleMenuChange(\"main-single-target\")}\n              >\n                {\"<<<\"}\n              </DropDownItem>\n              <DropDownItem\n                handleClick={handleAlgorithmChange(\"Dijkstra's algorithm\")}\n              >\n                <p>Dijkstra's Algorithm</p>\n                {singleTargetAlgorithm === \"Dijkstra's algorithm\" ? (\n                  <p>✓</p>\n                ) : (\n                  \"\"\n                )}\n              </DropDownItem>\n              <DropDownItem handleClick={handleAlgorithmChange(\"A* algorithm\")}>\n                <p>A* Algorithm</p>\n                {singleTargetAlgorithm === \"A* algorithm\" ? <p>✓</p> : \"\"}\n              </DropDownItem>\n            </WrapperCSSTransition>\n          </DropDownMenu>\n        </NavItem>\n      </NavBar>\n\n      <Grid\n        grid={grid}\n        pairGrid={pairGrid}\n        maze={maze}\n        mouseState={mouseIsPressed}\n        handleMouseDown={handleMouseDown}\n        handleMouseEnter={handleMouseEnter}\n      />\n    </div>\n  );\n};\n\nexport default Visualizer;\n"]},"metadata":{},"sourceType":"module"}